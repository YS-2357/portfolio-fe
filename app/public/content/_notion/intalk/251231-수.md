---
태그: []
날짜: "2025-12-31"
이름: "25.12.31 (수)"
---

# 25.12.31 (수)


# 📅 날짜: 25.12.31 (수)


## 🧩 주요 업무


- PartnersAI 백엔드 **배포 준비 완료** 및 CI/CD 검증 완료함.

- 미션 체계를 Rolefit(규칙), Mindset/Conversation/Term(LLM) **4개 미션으로 고정**하고 문서 전면 최신화 수행함.

- LLM 호출 비용·지연을 줄이기 위한 **캐시 계층(SQLite/Redis/Memory) 구현** 및 캐시 통계/로깅(HIT/MISS) 추가함.

- Rolefit에서 LLM 의존을 제거하고 **규칙 기반 점수 산정**으로 확정하여 프롬프트/설정/테스트를 정리함.

- 미션별 입력 길이 제한을 스키마에 반영하여 품질 저하 입력을 사전에 차단하고, Pydantic 검증 기반으로 422 응답을 표준화함.

- 테스트/의존성/보안/도커를 배포 기준으로 재정렬하여 **pytest 47개 통과, Docker 빌드 성공, CI 정상 동작** 상태 확보함.

## 🎯 목표 정리


### 장기 목표


- PartnersAI를 “문서화된 미션 설계 + 프롬프트 버전 관리 + 실험/검증 + 배포 자동화”로 운영 가능한 제품 형태로 고정하는 목표 설정함.

- Rolefit은 규칙 기반으로 안정성을 확보하고, 나머지 미션은 프롬프트/테스트/캐시로 품질·비용을 제어하는 구조 확립 목표 설정함.

### 단기 목표


- GitHub push 이후 CI 통과를 확인하고, Docker 기반 프로덕션 배포를 수행하는 목표 설정함.

- Redis 캐시 적용 여부와 CORS 도메인 제한 범위를 운영 정책으로 확정하는 목표 설정함.

- 인수인계 산출물(핵심 설계/배포 절차/운영 체크리스트)을 문서 단위로 마무리하는 목표 설정함.

## ⚙️ 진행 및 이슈


- **문서 전면 최신화**

- **LLM 캐시 시스템 구현**

- **Rolefit 프롬프트 제거**

- **입력 길이 제한 도입**

- **테스트/의존성/보안/도커 정리**

- **미해결 과제**

## 🧠 느낀 점 및 개선


- “배포 가능한 상태”의 정의를 테스트 통과에 한정하지 않고, 문서/환경변수/보안/도커까지 포함하는 체크리스트로 유지할 필요 정리함.

- 입력 제약과 에러 코드(422) 표준화로 품질 관리가 쉬워지므로, 동일 원칙을 다른 미션에도 확장하는 방향 필요함.

- 인수인계 기간에는 신규 기능 확대보다 운영 기준(설정, CI, 배포, 장애 포인트)의 문서화를 우선하는 운영 방식 필요함.

## 🤝 협업 및 커뮤니케이션


- BL 회의 공유 기준에 맞춰 PR/BL/TL 구조를 유지하고, 지표는 수치 기반으로 기록하는 원칙을 재확인함.

- 마케팅/제품 측면에서 랜딩·신청폼 이탈 구간의 카카오 채널 유도, 신청 완료 후 카카오톡 자동화는 파트너스 2.0 이후 단계로 합의함.

- 파트너스 2.0 진행 현황(백엔드 80%, AI 모듈 90%, 용어 300개 수집 등)과 차주 목표(백엔드 100%, 자동화 연결 등)를 정리함.

## 📚 참고 및 학습 내용


- Pydantic 검증을 통한 입력 품질 제어와 HTTP 422 표준화 패턴 학습함.

- 캐시 계층을 환경 변수로 교체 가능하게 설계하는 방식(SQLite↔Redis↔Memory) 정리함.

- 프로덕션 보안에서 문서 UI 비활성화, 의존성 분리, Docker 경량화의 기본 원칙 재확인함.

- CI에서 “테스트/린트 선행 후 Docker 빌드 검증” 파이프라인 구성 원칙 정리함.

## 📈 성과 및 지표


- 테스트: **47개 통과** 상태 확보함.

- Docker: `partnersai-test:latest` **빌드 성공** 확인함.

- CI: pytest+ruff+docker job 구성 및 정상 동작 상태 확보함.

- 문서: 4개 미션 설계/실험 프레임워크/규칙 문서/환경 변수 템플릿 최신화 완료함.

- 기능: LLM 캐시 시스템 구현 및 Rolefit 규칙 기반 전환 완료함.

## 🗓️ 내일 계획


- GitHub push 및 CI 통과 로그를 기준으로 배포 가능 상태를 최종 확인함.

- Docker 기반 프로덕션 배포 수행 및 `ENVIRONMENT=prod` 설정에서 문서 UI 비활성화 정상 동작 확인함.

- Redis 캐시 적용 여부를 운영 관점(성능 이득, 장애 포인트, 모니터링)에서 결정하고 적용 시 설정 검증함.

- CORS 도메인 제한 정책을 서비스 도메인 확정과 함께 적용함.

- 인수인계서에 “설정 키 목록, CI 흐름, 배포 절차, 장애 대응 포인트, 캐시 운영 정책”을 포함하여 마무리함.

```markdown
당신은 ‘업무일지와 회고 정리 전문가’다.  
아래 사용자의 입력을 바탕으로 하루치 업무일지를 Markdown 형식으로 작성하라.  
입력이 비어 있으면 디폴트 예시 내용을 넣는다.  
결과는 실제 업무 문서에 기록 가능한 수준의 정확성·간결성을 유지하라.

---

입력 형식:
[업무 내용]
1. 코드 업무
"""
# 2025-12-31 작업 일지

## 개요

PartnersAI 백엔드 배포 준비 및 CI/CD 검증 완료

---

## 1. 문서 전면 최신화

### 변경 파일
- `docs/MISSION_DESIGN.md` - 4개 미션 설계 문서
- `prompts/EXPERIMENTS.md` - A/B 테스트 프레임워크
- `SKILLS.md` - 개발 규칙 및 폴더 구조
- `.env.example` - 환경 변수 템플릿

### 주요 내용
- 4개 미션 반영: Rolefit, Mindset, Conversation, Term
- Rolefit은 규칙 기반 (LLM 프롬프트 없음)
- 프롬프트 버전 관리 체계 문서화

---

## 2. LLM 캐시 시스템 구현

### 신규 파일
- `app/llm/cache.py`

### 기능
| 캐시 타입 | 용도 | 설정 |
|----------|------|------|
| SQLite | 로컬/개발용 | `CACHE_TYPE=sqlite` |
| Redis | 분산/프로덕션 | `CACHE_TYPE=redis` |
| Memory | 테스트용 | `CACHE_TYPE=memory` |

### 환경 변수
```bash
CACHE_ENABLED=true
CACHE_TYPE=sqlite
CACHE_TTL=3600
REDIS_URL=redis://localhost:6379  # Redis 사용 시
```

### 로깅
- `[캐시 HIT]` / `[캐시 MISS]` 로그 출력
- `get_cache_stats()` 통계 함수 추가

---

## 3. Rolefit 프롬프트 제거

### 이유
- Rolefit은 **규칙 기반** 점수 계산 (LLM 호출 없음)
- 프롬프트 파일 불필요

### 변경사항
- `prompts/rolefit/analyze_0.1.0.md` 삭제
- `config.py`에서 `prompt_rolefit`, `llm_rolefit_*` 설정 제거
- 관련 테스트 수정

---

## 4. 미션별 입력 글자수 제한

### 스키마 변경
| 미션 | 필드 | 최소 | 최대 |
|------|------|------|------|
| Term | `user_explanation` | 10자 | 500자 |
| Mindset | `user_response` | 20자 | 1,000자 |
| Conversation | `script` | 50자 | 3,000자 |

### 적용 파일
- `app/features/term/schemas.py`
- `app/features/mindset/schemas.py`
- `app/features/conversation/schemas.py`

### Pydantic 검증
- 글자수 미달 시 HTTP 422 (Unprocessable Entity) 반환

---

## 5. pytest 테스트 수정

### 문제
- 10개 테스트 실패
- 원인: Pydantic 검증 에러 코드 (400 → 422), rolefit 설정 제거

### 수정 파일
| 파일 | 변경 내용 |
|------|----------|
| `tests/test_config.py` | rolefit 참조 제거 |
| `tests/test_api.py` | 400 → 422 수정 |
| `tests/test_prompt.py` | rolefit → conversation 변경 |
| `tests/test_features/test_conversation.py` | 422 + 긴 스크립트 사용 |
| `tests/test_features/test_term.py` | ValidationError 테스트 |
| `tests/test_features/test_mindset.py` | **신규 생성** (8개 테스트) |

### 결과
- **47개 테스트 통과**

---

## 6. 의존성 분리 및 프로덕션 보안

### 의존성 분리
| 파일 | 용도 | 포함 패키지 |
|------|------|------------|
| `requirements.txt` | 프로덕션 | FastAPI, LangChain, httpx |
| `requirements-dev.txt` | 개발용 | + pytest, streamlit |

### 버전 전략
- **FastAPI/Pydantic**: `==` 고정 (안정적)
- **LangChain**: `>=` 범위 (상호 의존성 해결)

### CI 의존성 충돌 해결
- LangChain 패키지 간 버전 충돌 발생
- `==` → `>=`로 변경하여 해결

### 프로덕션 보안
```python
# app/main.py
docs_url=None if settings.environment == "prod" else "/docs",
redoc_url=None if settings.environment == "prod" else "/redoc",
```
- `ENVIRONMENT=prod` 설정 시 Swagger UI 비활성화

---

## 7. Docker 빌드 검증

### Dockerfile
- `requirements.txt`만 사용 (streamlit, pytest 제외)
- 이미지 경량화

### 빌드 결과
```bash
docker build -t partnersai-test:latest .
# 성공
```

---

## 8. CI/CD 워크플로우

### 파일
`.github/workflows/ci.yml`

### 트리거
- push: `main`, `master`, `develop`, `dev`
- pull_request: `main`, `master`

### Jobs
```
test (requirements-dev.txt) ──┬──→ docker (requirements.txt)
lint (ruff) ──────────────────┘
```

### 상태
- pytest: 47개 통과
- Docker: 빌드 성공
- CI: 정상 작동

---

## 커밋 히스토리

| 커밋 | 메시지 |
|------|--------|
| `57168cd` | docs: 문서 전면 최신화 (4개 미션 반영) |
| `db17236` | feat: LLM 캐시 시스템 구현 (SQLite/Redis 지원) |
| `e0cd7da` | refactor: rolefit 프롬프트 제거 (규칙 기반이라 불필요) |
| `1b810e5` | feat: 캐시 히트/미스 로깅 추가 |
| `a009483` | chore: .dockerignore 정리 |
| `7bc9451` | feat: 미션별 입력 글자수 제한 추가 및 문서 최신화 |
| `d7afd72` | test: pytest 수정 및 test_mindset.py 추가 |
| `a4a05bd` | chore: 의존성 분리 및 프로덕션 보안 설정 |
| `d1589e9` | fix: LangChain 의존성 버전 범위로 변경 |
| `8c57544` | docs: README 설치 섹션 업데이트 |
| `8b1fd5e` | docs: SKILLS.md 최신화 |

---

## 다음 작업

- [ ] GitHub push 후 CI 통과 확인
- [ ] 프로덕션 배포 (Docker)
- [ ] Redis 캐시 설정 (선택)
- [ ] CORS 도메인 제한 (필요 시)
"""
2. 회의 업무
"""
파트너스 랜딩 페이지 헤더에 카카오톡 로고 추가
신청폼 중간 이탈시 채널 유도
신청폼 완료 시 카카오톡 연락 자동화 >  파트너스 2.0 이후 
카카오톡 채널 메시지 실험
4. Bottom-Line 회의 (수요일 오후) (각 KR 팀별로 회의자료 작성 후, BL 회의 시에는 주요 이슈/협업 요청사항만 논의)
PR
금주 Bottom Line 달성여부 체크
(미달성했더라도 달성률 구체적인 수치로 기록)
Top Line 설정
(최대달성 예상치에서 120% 상향된 정량 지표)
Link
(참고용)
1 카카오톡 채널 Growth/ 오픈채팅
① 전단지 (0/50)명 -> 오픈채팅방 (0/5)명 유입, 카카오 채널 (?/5)명 친구추가/일주일 새 57명 감소, 파트너스 신청폼 (1/5)명 작성
② 
③
① 파트너스 신청폼 10명 제출, 케어 주간 매출 55,000원 달성
② 네이버 파워링크 cpc 1,170원대 -> 600원대로 낮추기, 카카오 배너광고 재개
③ 인톡 파트너스 초보자용 전자책 발간
①
②
③
2.Owned Media 운영
① TL: 팔로우 수 10명 증가
네이버 블로그 4명 증가
인스타그램 2명 증가
페이스북 0명 증가
② 
③ 
① 주간 조회수 목표 (노출 수 증가)
네이버 블로그 50 -> 100 달성
인스타그램 6900 -> 1만 달성
페이스북 1만 -> 1만 5천 달성
② 
③ 



3.오프라인 마케팅
① 
②
③ 


① 
② 
③ 
①
②
③
4.인톡 케어 운영·전환 
① 인톡 케어 쿠키 마이그레이션
백엔드 api gateway 커스텀 도메인 설정
같은 root 도메인을 공유하여 first-party cookie로 인식되도록 변경
② 인톡 케어 모바일 구현
온보딩 관리, 마이페이지 우선 구현
③ 



① 인톡 케어 모바일 구현
온보딩 관리, 마이페이지 우선 구현
② 
③ 


5. 인톡 파트너스 2.0 
① 백엔드 API 80%(로깅 ,유저,레벨, 케어 연계) 완료
② 프론트 디자인 및 랜딩 페이지 카피라이팅 지정 완료
③ 미션 AI 모듈 제작 90% 완료
① 백엔드 100% 완성 목표
- 미션 시스템에 AI 모듈 붙히기, 테스트 코드 작성 
② 신청폼 완료 시 카카오톡 연락 자동화(카카오 API) 연결
③ 
① 프론트 디자인
②
③
6. AI 롤플레이
① 파트너스2.0 AI서비스 MVP제작 완료
② 4개 미션/ API 엔드포인트 설계/구현
③ 보험용어 300개 수집 완료
① 파트너스2.0 백엔드 완성
② 인톡 케어 서비스 Scriptmate 확인
③ 인수인계서 작성
①
②
③
7. 전사 데이터·분석
① 프로젝트 현황판 
② 홈   - 회의 시스템
③ 
① 템플릿–?, 대시보드 슬랙 & 노션 연계
② 매체별 CAC 측정
③ 
①
②
③
 8. AI 툴 개선 
① Scriptmate 라이브 stt 기능 추가 
② stt 이후 라이브로 대사 추천 기능 추가
③
① STT 성능 개선, 인물 분리
②
③
①
②
③
 9. 인톡 서포즈
① 미션 2 시작
① 
"""

[느낀 점]
1. 업무를 찾기 힘들다. 아무리 이틀밖에 남지 않았다지만 조금 아쉽다. 인수인계만 잘 마무리하자.

---

출력 양식:

# 📅 날짜: (예: 25.11.11 (화))

## 🧩 주요 업무
- 오늘 수행한 핵심 업무를 구체적으로 요약  
- 기술적 결과, 진행 상황, 산출물 등을 명시  

## 🎯 목표 정리
### 장기 목표
- 프로젝트의 중장기적 방향 또는 최종 지향점  
### 단기 목표
- 오늘 혹은 이번 주 달성 목표  

## ⚙️ 진행 및 이슈
- 진행 단계별 구체적 내용  
- 발생한 문제와 해결 과정  
- 미해결 과제 및 후속 조치  

## 🧠 느낀 점 및 개선
- 사용자 입력 기반으로 정리된 통찰, 개선 아이디어, 학습 내용  

## 🤝 협업 및 커뮤니케이션
- 회의, 보고, 협업 이슈, 의사소통 내용 정리  
- 논의된 결정사항 및 향후 조율 방향  

## 📚 참고 및 학습 내용
- 새로 학습하거나 참고한 기술·논문·문서  
- 업무 개선에 도움이 된 개념 또는 자료  

## 📈 성과 및 지표
- 정량적 성과(예: 정확도, 속도, 효율 등)  
- 수치가 없을 경우 주요 진척도를 서술  

## 🗓️ 내일 계획
- 다음 업무 목표 및 우선순위  
- 예상 리스크 및 대비책  

---

지침:
1. 전체 분량은 500~650단어 이내로 유지한다.  
2. 문장은 명사형·서술형으로 끝내며, 감정적 표현은 제외한다.  
3. 입력이 비어 있으면 아래 기본 내용을 자동으로 채운다.
4. 날짜는 월화수목금의 요일만 사용한다.

---

[기본 디폴트 예시]
- **업무 내용**: LangChain 실습 복습, 문서 분석 코드 개선, 팀 회의 참석  
- **느낀 점**: 구조화된 학습이 업무 이해에 도움됨. 반복 작업 효율 개선 필요.
```



