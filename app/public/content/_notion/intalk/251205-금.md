---
태그: []
날짜: "2025-12-05"
이름: "25.12.05 (금)"
---

# 25.12.05 (금)


# 📅 날짜: 25.12.05 (금)


## 🧩 주요 업무


- PDF 파싱 기능을 단일 책임 구조로 리팩토링하고, 테이블 추출 후 JSON 형태로 반환하는 구조 확립

- 기존 PDF 분석 코드에서 계산·분류 기능을 제거하고 `coverage_classifier.py`로 모듈 분리

- 실손/정액요약/정액상세 테이블을 키워드 기반으로 자동 분류할 수 있도록 조건 개선

- 정액요약 테이블의 멀티헤더 파싱 오류를 확인하고 재설계 필요 구간 도출

- 노트북 환경에서 신규 분류 모듈·파서 기능 테스트 수행

## 🎯 목표 정리


### 장기 목표


- 보험가입내역 PDF를 안정적으로 구조화하여 보장분석 GPT의 초기 입력(JSON 스키마)을 표준화하고, 모든 보험사 PDF에 적용 가능한 범용 파서 확보

- 실손·정액·보장 유형·납입 정보 등 핵심 보험 정보를 완전 자동 분류·계산할 수 있는 백엔드 기반 정합성 엔진 구축

### 단기 목표


- pdf_parser와 coverage_classifier 간 역할을 명확히 분리하고, 테이블 구조·헤더 처리·유형 분류 기능을 재사용 가능하도록 정비

- 멀티헤더가 포함된 정액요약 테이블의 스키마 정규화 방식 설계 및 개선안 도출

## ⚙️ 진행 및 이슈


- `pdf_parser.py`에서 계산 관련 로직을 제거하고, 파싱 역할만 유지하도록 모듈 구조 정리

- 신규 생성된 `coverage_classifier.py`에 금액 파싱, 테이블 유형 판별, 보장 유형 분류, 월납입료 계산 등 분류·계산 기능을 집중 배치

- 파싱된 raw 테이블을 키워드 기반으로 실손/정액요약/정액상세로 분류하도록 조건 개선

- 정액요약 테이블의 멀티헤더 구조로 인해 일부 컬럼이 빈 헤더로 파싱되고, 업권별 금액이 정상 매핑되지 않는 문제 발견

- 사용하지 않는 파일(`llm_extractor.py`, 기획 문서 등)을 정리 대상으로 지정하였으며, analyzer 및 standard_loader는 후속 검토 예정

- Jupyter 노트북 기반 테스트에서 신규 분류 로직 검증을 진행하고, 정상 작동 범위 및 문제 구간을 명확히 식별

## 🧠 느낀 점 및 개선


- PDF 파싱과 보험 도메인 분류 로직을 분리한 이번 구조 개편은 유지보수성·확장성을 높이는 방향으로 적절함

- 멀티헤더·병합셀 등 보험사별 상이한 PDF 구조에 대응하기 위해, 기존 헤더 기반 분류 방식만으로는 한계가 분명하며, 키워드 기반 탐지와 스키마 정규화가 필수 작업임

- 보험 PDF 파서는 단순 텍스트 추출이 아니라 “의미 기반 구조 복원”이 핵심이므로, 처리 기준과 예외 케이스를 명확히 문서화해야 함

## 🤝 협업 및 커뮤니케이션


- 정액요약 테이블의 스키마 불일치 문제를 팀 단위로 공유하고, 업권별 금액이 필요한 downstream 모듈(보장분석, 통계 처리 등)과의 요구사항 확인 예정

- coverage_classifier의 기능 확장 여부를 차후 백엔드와 협의하여, 분석기(analyzer)와 중복되지 않는 구조를 확정할 필요 존재

## 📚 참고 및 학습 내용


- PDF 테이블 파싱에서 멀티헤더 처리 방식 사례(Pandas MultiIndex, Camelot/Tabula 병합 패턴)

- 보험사별 실손/정액 테이블 공통 요소 및 변형 패턴

- 금액 문자열 파싱(억·만·천 단위)과 보험 도메인 상 표기 특성

## 📈 성과 및 지표


- 파싱 모듈과 분류 모듈 간 명확한 레이어 분리가 완료되어 이후 유지보수 난이도 감소

- 키워드 기반 테이블 분류 도입으로 PDF 구조 차이 대응력 향상

- 노트북 테스트에서 신규 모듈 주요 기능 검증 완료

## 🗓️ 내일 계획


- 정액요약 테이블 멀티헤더 정규화 로직 초안 설계

- 보장 유형 판별 로직 확장(실손/정액/만기/갱신/배당 등 세분화)

- analyzer 및 standard_loader 역할 통합 여부 검토

- 전체 파서 체인의 JSON 출력 스키마 재정의 및 문서화

```json
당신은 ‘업무일지와 회고 정리 전문가’다.  
아래 사용자의 입력을 바탕으로 하루치 업무일지를 Markdown 형식으로 작성하라.  
입력이 비어 있으면 디폴트 예시 내용을 넣는다.  
결과는 실제 업무 문서에 기록 가능한 수준의 정확성·간결성을 유지하라.

---

입력 형식:
[업무 내용]
1. 보장분석 gpt 개발업무
"""
# 2025-12-05 작업 기록

## 목표
PDF 파싱 기능 리팩토링 - 테이블 추출 + JSON 반환 구조로 단순화

## 완료된 작업

### 1. pdf_parser.py 정리
- `calculate_monthly_premium()`, `calculate_premium_ratio()` 함수 제거
- 순수 파싱 기능만 유지 (실손/정액요약/정액상세 테이블 추출)

### 2. coverage_classifier.py 신규 생성
파싱된 데이터 기반 분류/계산 로직 분리

**포함된 함수:**
- `parse_amount()` - 금액 문자열 파싱 (억/만/천 단위)
- `classify_table()` - 테이블 유형 분류
- `classify_tables()` - raw 테이블 → 실손/정액 분류
- `classify_coverage_type()` - 보장 유형 판별 (종신/갱신/무배당)
- `calculate_monthly_premium()` - 월납입료 계산
- `calculate_premium_ratio()` - 소득대비 비율 계산

### 3. 불필요한 파일 제거 (스테이징 상태)
- `backend/llm_extractor.py` - 사용되지 않음
- `docs/pdf_parser_refactor_plan.md` - 계획 문서

### 4. 노트북 테스트
- `notebooks/pdf_parser_v2_test.ipynb` - coverage_classifier 테스트 셀 추가

## 발견된 이슈

### 정액요약 테이블 멀티헤더 문제
PDF 원본 구조:
```
순번 | 보장명 | 가입(건) | 가입금액 합계(원) |     업권별 가입금액(원)
                                           | 손해보험회사 | 생명보험회사 | 공제(체신관서)
```

현재 파싱 결과:
- "손해보험회사" 컬럼은 "업권별 가입금액(원)"으로 매핑됨
- "생명보험회사", "공제(체신관서)" 컬럼은 빈 헤더로 처리되어 일부 데이터 누락

**해결 방안 검토 필요**

## 파일 구조 (현재)

```
backend/
├── app.py              # FastAPI (유지)
├── chatbot.py          # 챗봇 (유지)
├── pdf_parser.py       # PDF 파싱 (수정됨)
├── coverage_classifier.py  # 분류/계산 (신규)
├── schemas.py          # 스키마 (유지)
├── analyzer.py         # 분석기 (유지, 추후 검토)
└── standard_loader.py  # 표준 로더 (유지, 추후 검토)
```

### 5. pdf_parser.py 테이블 분류 조건 개선
기존 헤더 기반 분류에서 **키워드 기반 분류**로 변경

**실손 테이블 판별:**
```python
실손_키워드 = ["자기부담", "자부담", "본인부담", "공제금", "면책금", "%보상", "실손"]
```
- 자기부담/본인부담은 실손보험 고유 개념
- 헤더 + 첫 2~3행 데이터에서 키워드 검색

**정액요약 테이블 판별:**
```python
요약_키워드 = ["가입(건)", "합계", "업권별"]
```
- 가입 건수, 합계 금액은 요약 테이블 고유

**정액상세 테이블 판별:**
```python
상세_키워드 = ["상품명", "담보명", "납입주기", "담보상태"]
```
- 개별 상품/담보 정보는 상세 테이블 고유

## 다음 작업
1. 정액요약 멀티헤더 파싱 개선
2. 보장 유형 판별 로직 고도화 (실손/정액/배당/만기/갱신)
3. 기존 파일 정리 여부 결정 (analyzer.py, standard_loader.py 등)

"""
2. (회의, 개발, 보고 등)

[느낀 점]
1. (업무 중 느낀 점, 개선점, 배운 점 등)

---

출력 양식:

# 📅 날짜: (예: 25.11.11 (화))

## 🧩 주요 업무
- 오늘 수행한 핵심 업무를 구체적으로 요약  
- 기술적 결과, 진행 상황, 산출물 등을 명시  

## 🎯 목표 정리
### 장기 목표
- 프로젝트의 중장기적 방향 또는 최종 지향점  
### 단기 목표
- 오늘 혹은 이번 주 달성 목표  

## ⚙️ 진행 및 이슈
- 진행 단계별 구체적 내용  
- 발생한 문제와 해결 과정  
- 미해결 과제 및 후속 조치  

## 🧠 느낀 점 및 개선
- 사용자 입력 기반으로 정리된 통찰, 개선 아이디어, 학습 내용  

## 🤝 협업 및 커뮤니케이션
- 회의, 보고, 협업 이슈, 의사소통 내용 정리  
- 논의된 결정사항 및 향후 조율 방향  

## 📚 참고 및 학습 내용
- 새로 학습하거나 참고한 기술·논문·문서  
- 업무 개선에 도움이 된 개념 또는 자료  

## 📈 성과 및 지표
- 정량적 성과(예: 정확도, 속도, 효율 등)  
- 수치가 없을 경우 주요 진척도를 서술  

## 🗓️ 내일 계획
- 다음 업무 목표 및 우선순위  
- 예상 리스크 및 대비책  

---

지침:
1. 전체 분량은 500~650단어 이내로 유지한다.  
2. 문장은 명사형·서술형으로 끝내며, 감정적 표현은 제외한다.  
3. 입력이 비어 있으면 아래 기본 내용을 자동으로 채운다.
4. 날짜는 월화수목금의 요일만 사용한다.

---

[기본 디폴트 예시]
- **업무 내용**: LangChain 실습 복습, 문서 분석 코드 개선, 팀 회의 참석  
- **느낀 점**: 구조화된 학습이 업무 이해에 도움됨. 반복 작업 효율 개선 필요.
```

